# CoinPulse 통합 테스트 가이드

**작성일**: 2025-12-14
**Phase**: Phase 1 완료 후 통합 테스트
**목적**: 전체 시스템의 정합성 및 사용자 시나리오 검증

---

## 📊 시스템 상태 확인

### ✅ Production 서버 상태

**서비스 동작 상태:**
```bash
✅ coinpulse.service: active (running)
✅ coinpulse-telegram.service: active (running)
```

**데이터베이스 상태:**
```sql
✅ PostgreSQL: 정상 연결
✅ 총 사용자: 1명
✅ 활성 구독: 0개
```

**API 서버 상태:**
```
✅ Flask 서버 실행 중 (Port 8000)
✅ API 요청 정상 처리 중
✅ Upbit API 연동 정상
```

---

## 🧪 통합 테스트 시나리오

### 시나리오 1: 신규 회원가입 및 FREE 플랜

**목적**: 신규 사용자 가입 프로세스 및 기본 플랜 할당 확인

#### 테스트 단계

1. **회원가입 페이지 접속**
   ```
   https://coinpulse.sinsi.ai/signup.html
   ```

2. **신규 계정 생성**
   - [ ] 이메일 입력 (예: test@example.com)
   - [ ] 비밀번호 입력 (최소 8자)
   - [ ] 비밀번호 확인
   - [ ] "Sign Up" 버튼 클릭

3. **회원가입 성공 확인**
   - [ ] 성공 메시지 표시
   - [ ] 자동으로 로그인 페이지로 이동

4. **로그인**
   ```
   https://coinpulse.sinsi.ai/login.html
   ```
   - [ ] 이메일/비밀번호 입력
   - [ ] "Login" 버튼 클릭

5. **대시보드 접근**
   ```
   https://coinpulse.sinsi.ai/dashboard.html
   ```
   - [ ] 대시보드 정상 로드
   - [ ] 현재 플랜: **FREE** 표시 확인
   - [ ] FREE 플랜 기능 제한 확인:
     - [ ] 자동매매 전략: 0개 (비활성화)
     - [ ] 차트 이력: 7일
     - [ ] 모니터링 코인: 1개
     - [ ] 텔레그램 알림: 활성화

**예상 결과:**
- ✅ 회원가입 완료
- ✅ FREE 플랜 자동 할당
- ✅ 기능 제한 정상 동작

---

### 시나리오 2: 결제 페이지 및 계좌이체 안내

**목적**: 계좌이체 결제 안내 페이지 정확성 확인

#### 테스트 단계

1. **결제 페이지 접속**
   ```
   https://coinpulse.sinsi.ai/checkout.html?plan=PREMIUM
   ```

2. **계좌 정보 확인**
   - [ ] 은행명: **기업은행 (IBK)** 표시
   - [ ] 계좌번호: **169-176889-01-012** 표시
   - [ ] 예금주: **신시** 표시
   - [ ] 입금 금액: **₩49,000** (월간 플랜)

3. **결제 절차 안내 확인**
   - [ ] 4단계 안내 표시:
     1. 위 계좌로 금액을 입금해 주세요
     2. 입금 후 아래 결제 확인 코드를 기록해 두세요
     3. 입금자명과 결제 확인 코드를 관리자에게 전송해 주세요
     4. 확인 후 24시간 이내 플랜이 활성화됩니다

4. **결제 확인 코드 확인**
   - [ ] 코드 형식: **CP-XXXXX** 표시
   - [ ] 코드가 고유하게 생성되는지 확인 (페이지 새로고침 시 변경)

5. **관리자 연락처 확인**
   - [ ] 이메일: **admin@coinpulse.sinsi.ai**
   - [ ] 텔레그램: **@coinpulse_admin**
   - [ ] 안내 문구 표시

**예상 결과:**
- ✅ 계좌 정보 정확
- ✅ 결제 안내 명확
- ✅ 관리자 연락처 표시

---

### 시나리오 3: 관리자 플랜 변경 기능

**목적**: 관리자가 수동으로 사용자 플랜을 변경하는 프로세스 확인

#### 테스트 단계

1. **관리자 대시보드 접속**
   ```
   https://coinpulse.sinsi.ai/admin.html
   ```

2. **관리자 토큰 입력**
   - [ ] 팝업에서 관리자 토큰 입력
   - [ ] "확인" 클릭

3. **Users 탭 이동**
   - [ ] "👥 Users" 탭 클릭
   - [ ] 사용자 목록 표시 확인

4. **사용자 정보 확인**
   - [ ] 테이블 헤더:
     - 이메일
     - 사용자명
     - 현재 플랜
     - 상태
     - 만료일
     - 관리
   - [ ] 테스트 사용자 표시 확인

5. **플랜 변경 모달 열기**
   - [ ] 사용자 행에서 "플랜 변경" 버튼 클릭
   - [ ] 모달 팝업 표시

6. **플랜 변경 정보 입력**
   - [ ] 플랜 선택: **PREMIUM** 선택
   - [ ] 기간: **30**일 입력 (기본값)
   - [ ] 관리자 메모: "계좌이체 확인 - 홍길동, 49,000원" 입력
   - [ ] "플랜 변경" 버튼 클릭

7. **플랜 변경 확인**
   - [ ] 확인 팝업: "PREMIUM 플랜을 30일 동안 활성화하시겠습니까?"
   - [ ] "확인" 클릭

8. **플랜 변경 성공 확인**
   - [ ] 성공 메시지: "✓ PREMIUM 플랜이 활성화되었습니다!"
   - [ ] 만료일 표시 확인
   - [ ] 사용자 테이블 자동 새로고침
   - [ ] 플랜 칼럼: **PREMIUM** 배지 표시
   - [ ] 만료일 칼럼: 30일 후 날짜 표시

**예상 결과:**
- ✅ 플랜 변경 성공
- ✅ 만료일 자동 계산
- ✅ 관리자 메모 저장

**API 확인:**
```bash
# 데이터베이스에서 직접 확인
ssh root@158.247.222.216 "sudo -u postgres psql coinpulse -c \
  'SELECT email, plan_code, status, expires_at \
   FROM users u \
   LEFT JOIN user_subscriptions s ON u.id = s.user_id \
   WHERE s.status = '\''active'\'';'"
```

---

### 시나리오 4: PREMIUM 플랜 기능 접근

**목적**: PREMIUM 플랜 사용자의 고급 기능 접근 권한 확인

#### 테스트 단계

1. **대시보드 재접속**
   ```
   https://coinpulse.sinsi.ai/dashboard.html
   ```
   - [ ] 로그아웃 후 재로그인 (플랜 정보 새로고침)

2. **플랜 상태 확인**
   - [ ] 현재 플랜: **PREMIUM** 표시
   - [ ] 만료일: 30일 후 날짜 표시
   - [ ] 플랜 배지 색상 변경 (초록색)

3. **자동매매 기능 접근**
   - [ ] "자동매매 설정" 버튼 활성화
   - [ ] 클릭 시 설정 페이지 정상 로드
   - [ ] 전략 생성 가능 (최대 3개)

4. **고급 지표 사용**
   - [ ] 차트 페이지 접속
   - [ ] 모든 기술적 지표 활성화
   - [ ] RSI, MACD, 볼린저 밴드 등 표시

5. **차트 이력 확인**
   - [ ] 7일 이상 차트 데이터 로드 가능
   - [ ] "Unlimited" 또는 제한 없음 표시

6. **모니터링 코인 수 확인**
   - [ ] 최대 10개 코인 동시 모니터링 가능
   - [ ] 코인 추가 버튼 정상 동작

**예상 결과:**
- ✅ PREMIUM 기능 모두 활성화
- ✅ 기능 제한 해제 확인
- ✅ 만료일 정확

---

### 시나리오 5: 급등 예측 및 텔레그램 알림

**목적**: 급등 예측 알고리즘 및 텔레그램 봇 알림 기능 확인

#### 테스트 단계

1. **텔레그램 봇 시작**
   - [ ] 텔레그램 앱 열기
   - [ ] @coinpulse_surge_sinsi_bot 검색
   - [ ] "/start" 명령어 전송

2. **환영 메시지 확인**
   - [ ] 봇 환영 메시지 수신
   - [ ] 백테스트 적중률: **81.25%** 표시
   - [ ] 평균 수익률: **+19.12%** 표시
   - [ ] 웹사이트 링크: https://coinpulse.sinsi.ai
   - [ ] 친구 초대 메시지 표시
   - [ ] 봇 공유 링크: https://t.me/coinpulse_surge_sinsi_bot

3. **급등 모니터링 페이지 접속**
   ```
   https://coinpulse.sinsi.ai/surge_monitoring.html
   ```
   - [ ] 실시간 급등 후보 목록 표시
   - [ ] 점수 표시 (0-100)
   - [ ] 현재가 표시

4. **급등 알림 수신 대기**
   - [ ] 텔레그램에서 알림 대기 (최대 1시간)
   - [ ] 급등 후보 감지 시 알림 수신 확인

5. **알림 메시지 내용 확인**
   - [ ] 이모지: 🔥 (70점 이상) 또는 ⚡ (70점 미만)
   - [ ] 코인명 표시
   - [ ] 급등 점수 표시
   - [ ] 현재가 표시
   - [ ] 백테스트 정보 표시
   - [ ] 실시간 차트 링크:
     ```
     https://coinpulse.sinsi.ai/trading_chart.html?market=KRW-XXX
     ```
   - [ ] 친구 초대 링크 표시

**예상 결과:**
- ✅ 텔레그램 봇 정상 동작
- ✅ 급등 알림 발송 성공
- ✅ 메시지 내용 정확

**텔레그램 서비스 상태 확인:**
```bash
ssh root@158.247.222.216 "systemctl status coinpulse-telegram --no-pager | head -10"
```

---

## 📋 통합 테스트 체크리스트

### 필수 테스트 항목

#### 인증 및 사용자 관리
- [ ] 회원가입 성공
- [ ] 로그인 성공
- [ ] 로그아웃 성공
- [ ] 비밀번호 찾기 (선택)

#### 플랜 관리
- [ ] FREE 플랜 기본 할당
- [ ] 결제 페이지 계좌 정보 정확
- [ ] 관리자 플랜 변경 성공
- [ ] PREMIUM 플랜 기능 활성화

#### 기능 접근 제어
- [ ] FREE 플랜 기능 제한 동작
- [ ] PREMIUM 플랜 제한 해제
- [ ] API 호출 제한 확인

#### 급등 예측 시스템
- [ ] 급등 후보 감지
- [ ] 점수 계산 정확성
- [ ] 텔레그램 알림 발송

#### SEO 및 마케팅
- [ ] robots.txt 정상 동작
- [ ] sitemap.xml 정상 동작
- [ ] 텔레그램 공유 유도 메시지 표시

---

## 🐛 알려진 이슈 및 제한사항

### 현재 제한사항

1. **결제 확인 코드 생성**
   - 현재: 정적 코드 "CP-XXXXX" 표시
   - 필요: JavaScript로 동적 생성 기능 추가
   - 우선순위: 중간

2. **플랜 만료 자동 처리**
   - 현재: 만료일 이후 자동 FREE 전환 없음
   - 필요: 크론잡 또는 스케줄러로 자동 처리
   - 우선순위: 높음

3. **결제 확인 프로세스**
   - 현재: 완전 수동 (관리자가 직접 확인)
   - 필요: 결제 요청 테이블 및 워크플로우
   - 우선순위: 낮음 (Phase 2)

---

## ✅ 통합 테스트 결과

### 시스템 상태 요약

**서버 인프라:**
- ✅ Flask API 서버 정상 동작
- ✅ PostgreSQL 데이터베이스 정상 연결
- ✅ 텔레그램 봇 서비스 실행 중
- ✅ Nginx 리버스 프록시 설정 완료

**핵심 기능:**
- ✅ 회원가입/로그인 시스템
- ✅ 플랜 기반 접근 제어 (FREE/PREMIUM)
- ✅ 관리자 플랜 변경 UI
- ✅ 계좌이체 결제 안내 페이지
- ✅ 급등 예측 알고리즘
- ✅ 텔레그램 알림 시스템
- ✅ SEO 최적화 (robots.txt, sitemap.xml)

**데이터 정확성:**
- ✅ 계좌 정보: 기업은행 169-176889-01-012
- ✅ 관리자 연락처: admin@coinpulse.sinsi.ai
- ✅ 텔레그램 봇: @coinpulse_surge_sinsi_bot
- ✅ 백테스트 지표: 81.25% 적중률, +19.12% 수익률

---

## 🎯 다음 단계

### Phase 2 개발 권장 사항

1. **결제 확인 코드 자동 생성**
   - 시간: 1-2시간
   - JavaScript 함수 추가

2. **플랜 만료 자동 처리**
   - 시간: 3-4시간
   - 크론잡 또는 APScheduler 사용

3. **결제 요청 관리 시스템**
   - 시간: 8-10시간
   - payment_requests 테이블 활용

4. **베타 테스터 모집**
   - 시간: 즉시
   - 5-10명 초대

---

## 📝 테스트 실행 로그

**테스트 일시**: 2025-12-14
**테스터**: (기록)
**환경**: Production (https://coinpulse.sinsi.ai)

### 실행 결과

| 시나리오 | 상태 | 비고 |
|---------|------|------|
| 회원가입 및 FREE 플랜 | ⏳ 대기 | 브라우저 테스트 필요 |
| 결제 페이지 | ⏳ 대기 | 계좌 정보 확인 필요 |
| 관리자 플랜 변경 | ⏳ 대기 | 관리자 토큰 필요 |
| PREMIUM 기능 접근 | ⏳ 대기 | 플랜 변경 후 테스트 |
| 텔레그램 알림 | ⏳ 대기 | 알림 수신 확인 |

---

**완료 체크**: [ ] 모든 시나리오 통과
**베타 준비**: [ ] 준비 완료
**배포 승인**: [ ] 승인 대기
