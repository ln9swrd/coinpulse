# 급등 예측 백테스트 가이드

## 📊 목적
급등 예측 알고리즘의 실제 성능을 과거 데이터로 검증

## 🎯 평가 기준

| 적중률 | 평가 | 조치 |
|--------|------|------|
| 70% 이상 | 🎉 EXCELLENT | 즉시 출시 가능 |
| 60-70% | ✅ GOOD | 출시 가능 |
| 50-60% | ⚠️ FAIR | 알고리즘 개선 권장 |
| 50% 미만 | ❌ POOR | 알고리즘 재설계 필요 |

## 🚀 실행 방법

### 1. 환경 설정
```bash
# Upbit API 키 필요 (.env 파일)
UPBIT_ACCESS_KEY=your_access_key
UPBIT_SECRET_KEY=your_secret_key
```

### 2. 백테스트 실행
```bash
python scripts/backtesting/surge_prediction_backtest.py
```

### 3. 예상 소요 시간
- API 호출 제한 고려: 약 **30-60분**
- 주간 단위 테스트 (7일마다)
- 총 약 14개 테스트 날짜

## 📈 백테스트 로직

### Step 1: 매 주 월요일 시뮬레이션
```
2024-09-01, 2024-09-08, 2024-09-15, ...
```

### Step 2: 급등 예측 실행
- 각 날짜에 모든 KRW 코인 분석
- 60점 이상 코인 선정
- 5가지 지표 점수 계산:
  - 거래량 증가 (20점)
  - RSI 과매도 회복 (25점)
  - 지지선 근접 (20점)
  - 상승 추세 (20점)
  - 가격 모멘텀 (15점)

### Step 3: 3일 후 수익률 확인
```
매수: 2024-09-01 종가
매도: 2024-09-04 종가
수익률 = (매도가 - 매수가) / 매수가 * 100
```

### Step 4: 적중률 계산
```
적중률 = (수익률 > 0인 거래 수) / 전체 거래 수 * 100
```

## 📊 결과 분석

### 출력 파일
```
docs/backtest_results/surge_prediction_backtest.json
```

### JSON 구조
```json
{
  "config": { ... },
  "backtest_period": {
    "start": "2024-09-01",
    "end": "2024-12-12",
    "holding_days": 3
  },
  "candidates": [ ... ],
  "results": [
    {
      "date": "2024-09-01",
      "market": "KRW-XRP",
      "score": 75,
      "buy_price": 750,
      "sell_price": 820,
      "return_pct": 9.33,
      "success": true
    }
  ],
  "summary": {
    "total_trades": 150,
    "winning_trades": 105,
    "losing_trades": 45,
    "win_rate": 70.0,
    "avg_return": 3.5,
    "avg_win": 8.2,
    "avg_loss": -4.1
  }
}
```

## 🔍 주요 지표 해석

### Win Rate (적중률)
- **의미**: 수익이 난 거래의 비율
- **목표**: 60% 이상
- **우수**: 70% 이상

### Average Return (평균 수익률)
- **의미**: 모든 거래의 평균 수익률
- **목표**: 2% 이상
- **우수**: 5% 이상

### Risk/Reward Ratio
```
Ratio = 평균 수익 / |평균 손실|
```
- **목표**: 1.5 이상
- **우수**: 2.0 이상

## ⚠️ 주의사항

### API Rate Limit
- Upbit API: 초당 10회 제한
- 스크립트에 자동 딜레이 포함 (0.1초)
- 중간 결과 자동 저장

### 데이터 누락
- 일부 코인은 과거 데이터 없을 수 있음
- 상장폐지된 코인 제외됨
- 거래량 매우 적은 코인 자동 필터링

### 백테스트 한계
- **과거 성과 ≠ 미래 보장**
- 백테스트는 참고용
- 실전 투자 전 소액 테스트 필수

## 🎯 다음 단계

### 적중률 70% 이상
1. ✅ 급등 예측 UI 개발
2. ✅ 텔레그램 알림 봇 개발
3. ✅ 무료 베타 출시

### 적중률 60-70%
1. ⚠️ 알고리즘 일부 개선
2. ✅ 소규모 베타 테스트
3. ⚠️ 피드백 수집 후 개선

### 적중률 60% 미만
1. ❌ 알고리즘 재설계
2. ❌ 지표 가중치 조정
3. ❌ 새로운 지표 추가 검토

## 📞 문제 해결

### "API 인증 실패" 에러
- `.env` 파일에 Upbit API 키 확인
- `load_dotenv()` 실행 확인

### "Too Many Requests" 에러
- API Rate Limit 초과
- 스크립트 재실행 (중간 결과부터 이어서 실행)

### 결과가 너무 적음
- 테스트 기간 확대 (6개월로)
- 최소 점수 낮춤 (60 → 50)
- 주간 → 일간 테스트로 변경
