<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í…”ë ˆê·¸ë¨ ì—°ë™ ê°€ì´ë“œ</title>
    <style>
        /* Modal Overlay */
        .telegram-onboarding-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 9999;
            animation: fadeIn 0.3s ease;
        }

        .telegram-onboarding-overlay.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Modal Container */
        .telegram-onboarding-modal {
            background: white;
            border-radius: 24px;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: slideUp 0.4s ease;
            position: relative;
        }

        /* Header */
        .telegram-modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 40px 30px;
            text-align: center;
            border-radius: 24px 24px 0 0;
            position: relative;
        }

        .telegram-modal-header::before {
            content: 'ğŸ‰';
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 32px;
        }

        .telegram-modal-header::after {
            content: 'ğŸš€';
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 32px;
        }

        .telegram-icon {
            width: 80px;
            height: 80px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
        }

        .telegram-icon svg {
            width: 50px;
            height: 50px;
            fill: #2AABEE;
        }

        .telegram-modal-header h1 {
            color: white;
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 10px;
        }

        .telegram-modal-header p {
            color: rgba(255, 255, 255, 0.9);
            font-size: 16px;
            margin: 0;
        }

        /* Close Button */
        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 36px;
            height: 36px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s;
            z-index: 10;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .modal-close::before,
        .modal-close::after {
            content: '';
            position: absolute;
            width: 18px;
            height: 2px;
            background: white;
        }

        .modal-close::before {
            transform: rotate(45deg);
        }

        .modal-close::after {
            transform: rotate(-45deg);
        }

        /* Body */
        .telegram-modal-body {
            padding: 40px 30px;
        }

        .benefit-section {
            background: #f8f9fa;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 30px;
        }

        .benefit-section h3 {
            color: #1e293b;
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .benefit-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .benefit-item {
            display: flex;
            align-items: center;
            gap: 12px;
            color: #64748b;
            font-size: 15px;
        }

        .benefit-item::before {
            content: 'âœ“';
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            font-weight: bold;
        }

        /* Steps */
        .steps-container {
            margin-bottom: 30px;
        }

        .step {
            display: flex;
            gap: 20px;
            margin-bottom: 24px;
            padding: 20px;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 16px;
            transition: all 0.3s;
        }

        .step:hover {
            border-color: #667eea;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.1);
        }

        .step-number {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 18px;
            flex-shrink: 0;
        }

        .step-content {
            flex: 1;
        }

        .step-content h4 {
            color: #1e293b;
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .step-content p {
            color: #64748b;
            font-size: 14px;
            margin-bottom: 12px;
            line-height: 1.6;
        }

        .step-action {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
            text-decoration: none;
        }

        .step-action:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .step-action.secondary {
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
        }

        .step-action.secondary:hover {
            background: #f8f9fa;
        }

        /* Code Display */
        .link-code-display {
            display: none;
            background: #f8f9fa;
            border: 2px dashed #667eea;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            margin-top: 12px;
        }

        .link-code-display.active {
            display: block;
        }

        .link-code-label {
            color: #64748b;
            font-size: 13px;
            margin-bottom: 8px;
        }

        .link-code-value {
            font-size: 32px;
            font-weight: 800;
            color: #667eea;
            letter-spacing: 4px;
            font-family: 'Courier New', monospace;
        }

        .link-code-timer {
            color: #f59e0b;
            font-size: 13px;
            margin-top: 8px;
        }

        /* Footer */
        .telegram-modal-footer {
            padding: 20px 30px 30px;
            display: flex;
            gap: 12px;
        }

        .modal-footer-btn {
            flex: 1;
            padding: 14px 24px;
            border: none;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .modal-footer-btn.primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .modal-footer-btn.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(102, 126, 234, 0.3);
        }

        .modal-footer-btn.secondary {
            background: white;
            color: #64748b;
            border: 2px solid #e2e8f0;
        }

        .modal-footer-btn.secondary:hover {
            background: #f8f9fa;
        }

        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes slideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .telegram-onboarding-modal {
                width: 95%;
                max-height: 95vh;
            }

            .telegram-modal-header {
                padding: 30px 20px;
            }

            .telegram-modal-body {
                padding: 30px 20px;
            }

            .step {
                flex-direction: column;
                text-align: center;
            }

            .step-number {
                margin: 0 auto;
            }

            .telegram-modal-footer {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Telegram Onboarding Modal -->
    <div class="telegram-onboarding-overlay" id="telegramOnboardingModal">
        <div class="telegram-onboarding-modal">
            <!-- Header -->
            <div class="telegram-modal-header">
                <button class="modal-close" onclick="closeTelegramOnboarding()"></button>
                <div class="telegram-icon">
                    <svg viewBox="0 0 24 24">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4.64 6.8c-.15 1.58-.8 5.42-1.13 7.19-.14.75-.42 1-.68 1.03-.58.05-1.02-.38-1.58-.75-.88-.58-1.38-.94-2.23-1.5-.99-.65-.35-1.01.22-1.59.15-.15 2.71-2.48 2.76-2.69.01-.03.01-.14-.07-.2-.08-.06-.19-.04-.27-.02-.12.03-1.99 1.27-5.62 3.72-.53.36-1.01.54-1.44.53-.47-.01-1.38-.27-2.06-.49-.83-.27-1.49-.42-1.43-.88.03-.24.37-.48 1.02-.73 3.98-1.74 6.64-2.89 7.98-3.45 3.8-1.58 4.59-1.86 5.1-1.87.11 0 .36.03.52.16.14.11.17.26.19.37.01.06.03.24.01.37z"/>
                    </svg>
                </div>
                <h1>ì—”í„°í”„ë¼ì´ì¦ˆ í˜œíƒ í™œì„±í™”</h1>
                <p>í…”ë ˆê·¸ë¨ ì—°ë™ìœ¼ë¡œ ê¸‰ë“± ì•Œë¦¼ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ë°›ìœ¼ì„¸ìš”!</p>
            </div>

            <!-- Body -->
            <div class="telegram-modal-body">
                <!-- Benefits -->
                <div class="benefit-section">
                    <h3>ğŸ ì—°ë™í•˜ë©´ ì´ëŸ° í˜œíƒì´!</h3>
                    <div class="benefit-list">
                        <div class="benefit-item">ì‹¤ì‹œê°„ ê¸‰ë“± ì˜ˆì¸¡ ì•Œë¦¼ (ì ìˆ˜ 60ì  ì´ìƒ)</div>
                        <div class="benefit-item">ìƒì„¸í•œ ì‹œê·¸ë„ ë¶„ì„ (ê±°ë˜ëŸ‰, RSI, ì§€ì§€ì„  ë“±)</div>
                        <div class="benefit-item">ì°¨íŠ¸ ë§í¬ ì›í´ë¦­ ì ‘ì†</div>
                        <div class="benefit-item">24ì‹œê°„ ìë™ ëª¨ë‹ˆí„°ë§</div>
                    </div>
                </div>

                <!-- Steps -->
                <div class="steps-container">
                    <div class="step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h4>ì—°ë™ ì½”ë“œ ìƒì„±</h4>
                            <p>ì•„ë˜ ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ 6ìë¦¬ ì—°ë™ ì½”ë“œë¥¼ ìƒì„±í•˜ì„¸ìš”. (15ë¶„ê°„ ìœ íš¨)</p>
                            <button class="step-action" onclick="generateLinkCode()">
                                ğŸ“ ì½”ë“œ ìƒì„±í•˜ê¸°
                            </button>
                            <div class="link-code-display" id="linkCodeDisplay">
                                <div class="link-code-label">ì—°ë™ ì½”ë“œ</div>
                                <div class="link-code-value" id="linkCodeValue">------</div>
                                <div class="link-code-timer" id="linkCodeTimer">â° ìœ íš¨ì‹œê°„: 15ë¶„</div>
                            </div>
                        </div>
                    </div>

                    <div class="step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h4>í…”ë ˆê·¸ë¨ ë´‡ ì°¾ê¸°</h4>
                            <p>í…”ë ˆê·¸ë¨ ì•±ì—ì„œ @coinpulse_surge_sinsi_botì„ ê²€ìƒ‰í•˜ì„¸ìš”.</p>
                            <a href="https://t.me/coinpulse_surge_sinsi_bot" target="_blank" class="step-action">
                                ğŸ“± ë´‡ìœ¼ë¡œ ì´ë™í•˜ê¸°
                            </a>
                        </div>
                    </div>

                    <div class="step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h4>ì—°ë™ ì™„ë£Œí•˜ê¸°</h4>
                            <p>ë´‡ ëŒ€í™”ì°½ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”:</p>
                            <pre style="background: #f8f9fa; padding: 12px; border-radius: 8px; margin: 8px 0;">
/start
/link 123456 (ìƒì„±ëœ ì½”ë“œ ì…ë ¥)
                            </pre>
                            <p style="margin-top: 12px;">âœ… "ì—°ë™ë˜ì—ˆìŠµë‹ˆë‹¤!" ë©”ì‹œì§€ê°€ ë‚˜ì˜¤ë©´ ì™„ë£Œ!</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <div class="telegram-modal-footer">
                <button class="modal-footer-btn secondary" onclick="skipTelegramOnboarding()">
                    ë‚˜ì¤‘ì— í•˜ê¸°
                </button>
                <button class="modal-footer-btn primary" onclick="goToTelegramSettings()">
                    í…”ë ˆê·¸ë¨ ì„¤ì •ìœ¼ë¡œ ì´ë™
                </button>
            </div>
        </div>
    </div>

    <script>
        // Show modal
        function showTelegramOnboarding() {
            document.getElementById('telegramOnboardingModal').classList.add('active');
        }

        // Close modal
        function closeTelegramOnboarding() {
            document.getElementById('telegramOnboardingModal').classList.remove('active');
        }

        // Skip onboarding
        function skipTelegramOnboarding() {
            localStorage.setItem('telegram_onboarding_skipped', 'true');
            closeTelegramOnboarding();
        }

        // Go to telegram settings page
        function goToTelegramSettings() {
            window.location.href = '/telegram_settings.html';
        }

        // Generate link code
        async function generateLinkCode() {
            try {
                const token = localStorage.getItem('token');
                if (!token) {
                    alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                    return;
                }

                const response = await fetch('/api/telegram/link/generate', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    }
                });

                const data = await response.json();

                if (data.success) {
                    document.getElementById('linkCodeValue').textContent = data.code;
                    document.getElementById('linkCodeDisplay').classList.add('active');

                    // Start countdown timer
                    startCodeTimer(15 * 60); // 15 minutes
                } else {
                    alert('ì½”ë“œ ìƒì„± ì‹¤íŒ¨: ' + data.error);
                }
            } catch (error) {
                console.error('Error generating link code:', error);
                alert('ì½”ë“œ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // Timer for link code expiration
        function startCodeTimer(seconds) {
            const timerElement = document.getElementById('linkCodeTimer');
            let remaining = seconds;

            const interval = setInterval(() => {
                remaining--;
                const minutes = Math.floor(remaining / 60);
                const secs = remaining % 60;
                timerElement.textContent = `â° ìœ íš¨ì‹œê°„: ${minutes}ë¶„ ${secs}ì´ˆ`;

                if (remaining <= 0) {
                    clearInterval(interval);
                    timerElement.textContent = 'âš ï¸ ì½”ë“œê°€ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ìƒì„±í•´ì£¼ì„¸ìš”.';
                    timerElement.style.color = '#ef4444';
                }
            }, 1000);
        }

        // Auto-show modal if user just upgraded to enterprise
        window.addEventListener('DOMContentLoaded', () => {
            const showOnboarding = sessionStorage.getItem('show_telegram_onboarding');
            const skipped = localStorage.getItem('telegram_onboarding_skipped');

            if (showOnboarding === 'true' && skipped !== 'true') {
                showTelegramOnboarding();
                sessionStorage.removeItem('show_telegram_onboarding');
            }
        });
    </script>
</body>
</html>
